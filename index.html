<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ü‡πâ‡∏°‡∏™‡∏∞‡∏™‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô - ‡∏™‡πÇ‡∏£‡∏ä‡∏≤ ‡πÄ‡∏Æ‡∏á‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì (PDF A4 Optimized)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå Kanit ‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö */
        body, h1, h2, h3, h4, h5, h6, input, textarea, button, p, span { 
            font-family: 'Kanit', sans-serif !important; 
        }

        body { background-color: #f1f5f9; color: #1e293b; transition: all 0.3s ease; }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 320px;
        }

        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        
        .process-dot { width: 12px; height: 12px; border-radius: 50%; background: #3b82f6; position: relative; z-index: 10; }
        .process-line-v { width: 2px; background: #e2e8f0; position: absolute; top: 0; bottom: 0; left: 5px; z-index: 0; }

        /* --- PRINT OPTIMIZATION (A4 PDF) --- */
        @media print {
            @page { 
                size: A4; 
                margin: 15mm; 
            }
            .no-print { display: none !important; }
            body { background-color: white !important; padding: 0 !important; color: black !important; }
            main { margin-top: 0 !important; padding: 0 !important; width: 100% !important; }
            section { 
                page-break-inside: avoid; 
                margin-bottom: 20px !important; 
                border: 1px solid #e2e8f0 !important; 
                box-shadow: none !important;
            }
            header { 
                background: #002D62 !important; 
                color: white !important; 
                border-radius: 0 !important;
                padding-top: 2rem !important;
                padding-bottom: 2rem !important;
                -webkit-print-color-adjust: exact;
            }
            .chart-container { height: 280px !important; }
            .process-line-v { background: #cbd5e1 !important; }
            /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÉ‡∏´‡πâ‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏û‡∏¥‡∏°‡∏û‡πå‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° */
            #profileImg { border: 4px solid white !important; }
            /* ‡∏õ‡∏£‡∏±‡∏ö Layout ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© */
            .grid { display: block !important; }
            .md\:grid-cols-3, .lg\:grid-cols-2 { display: flex !important; flex-wrap: wrap !important; }
            .md\:col-span-2 { width: 65% !important; }
            .md\:justify-end { width: 35% !important; }
            .lg\:grid-cols-2 > div { width: 48% !important; margin: 1% !important; }
        }

        #adminPanelContent::-webkit-scrollbar { width: 6px; }
        #adminPanelContent::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- NAVIGATION (‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå) -->
    <nav class="no-print sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-slate-200 px-6 py-3">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-blue-900 rounded-lg flex items-center justify-center text-white font-bold text-xs">S</div>
                <div id="navTitle" class="font-bold text-blue-900 tracking-tight uppercase">SAROCHA.PORTFOLIO</div>
            </div>
            <div class="flex gap-2">
                <button onclick="window.print()" class="bg-blue-900 text-white px-5 py-2 rounded-full font-bold hover:bg-blue-800 transition text-sm flex items-center gap-2 shadow-lg">
                    üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF (A4)
                </button>
                <button id="adminBtn" onclick="toggleAdminPanel()" class="bg-amber-500 text-white px-4 py-2 rounded-full font-bold hover:bg-amber-600 transition text-sm flex items-center gap-2 shadow-lg">
                    ‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CRUD
                </button>
            </div>
        </div>
    </nav>

    <!-- HEADER SECTION -->
    <header class="bg-[#002D62] text-white pt-20 pb-28 px-6 relative overflow-hidden shadow-2xl">
        <div class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-12 items-center relative z-10">
            <div class="md:col-span-2 space-y-6 text-center md:text-left">
                <div id="positionLabel" class="inline-flex items-center gap-2 px-4 py-1.5 bg-cyan-500/20 text-cyan-400 text-xs font-bold rounded-full border border-cyan-500/30 tracking-wider uppercase">
                    <span class="no-print w-2 h-2 bg-cyan-400 rounded-full animate-pulse"></span>
                    ‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£ (‡∏≠‡∏õ‡∏ó. ‡∏¢‡∏∏‡∏Ñ‡πÉ‡∏´‡∏°‡πà)
                </div>
                <h1 id="userNameDisplay" class="text-5xl md:text-7xl font-extrabold leading-tight tracking-tighter">
                    ‡∏™‡πÇ‡∏£‡∏ä‡∏≤ <span class="text-cyan-400">‡πÄ‡∏Æ‡∏á‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì</span>
                </h1>
                <h2 id="sloganDisplay" class="text-2xl md:text-3xl text-amber-400 font-light italic">
                    "‡∏ô‡∏±‡∏Å‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô"
                </h2>
                <div class="flex flex-wrap gap-4 mt-8 justify-center md:justify-start">
                    <div class="flex items-center bg-white/5 px-5 py-3 rounded-2xl border border-white/10">
                        <span class="text-xl mr-3">üìû</span>
                        <div class="text-left">
                            <p class="text-[10px] text-white/50 uppercase">Phone</p>
                            <p id="phoneDisplay" class="font-bold text-sm">084-050-3121</p>
                        </div>
                    </div>
                    <div class="flex items-center bg-white/5 px-5 py-3 rounded-2xl border border-white/10">
                        <span class="text-xl mr-3">üìß</span>
                        <div class="text-left">
                            <p class="text-[10px] text-white/50 uppercase">Email</p>
                            <p id="emailDisplay" class="font-bold text-sm">kwangsaro.31@gmail.com</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-center md:justify-end">
                <div class="w-64 h-80 rounded-3xl border-[10px] border-white/10 shadow-2xl overflow-hidden bg-slate-800">
                    <img id="profileImg" src="https://img5.pic.in.th/file/secure-sv1/Gemini_Generated_Image_5nz7zj5nz7zj5nz7.png" 
                         alt="‡∏™‡πÇ‡∏£‡∏ä‡∏≤ ‡πÄ‡∏Æ‡∏á‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì" 
                         class="w-full h-full object-cover object-top">
                </div>
            </div>
        </div>
        <div class="no-print absolute top-0 right-0 w-[500px] h-[500px] bg-cyan-500/10 rounded-full blur-[100px] -mr-64 -mt-64"></div>
    </header>

    <!-- MAIN CONTENT -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-16 relative z-20 space-y-12 pb-24">

        <!-- CONCEPT SECTION -->
        <section class="bg-white rounded-[2rem] shadow-xl p-8 md:p-12 border-t-8 border-blue-900">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-12 items-center">
                <div class="lg:col-span-1">
                    <h3 class="text-3xl font-bold text-blue-900 mb-4 border-l-4 border-blue-900 pl-4">‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î "‡∏•‡πà‡∏≤‡∏°‡∏†‡∏≤‡∏©‡∏≤‡∏£‡∏±‡∏ê"</h3>
                    <p id="conceptSub" class="text-slate-500 leading-relaxed italic">
                        "‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà‡∏Å‡∏≤‡∏£‡∏û‡∏π‡∏î‡πÉ‡∏´‡πâ‡∏î‡∏±‡∏á ‡πÅ‡∏ï‡πà‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏π‡∏î‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à..."
                    </p>
                </div>
                <div class="lg:col-span-2 space-y-6">
                    <div class="p-6 bg-slate-50 rounded-2xl border-l-4 border-cyan-500 relative">
                        <div class="absolute top-[-10px] left-6 bg-cyan-500 text-white text-[10px] font-bold px-2 py-0.5 rounded uppercase">Core Value</div>
                        <p id="conceptMain" class="text-lg text-slate-700 leading-relaxed font-medium">
                            ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏ä‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢ ‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏¢‡∏±‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏±‡∏ê‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- EDUCATION SECTION -->
        <section class="bg-white rounded-[2rem] shadow-xl p-8 md:p-12 border-l-8 border-blue-900 overflow-hidden relative">
            <h3 class="text-3xl font-bold text-blue-900 mb-8 border-l-4 border-amber-500 pl-4">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                <div class="flex items-start gap-6">
                    <div class="w-16 h-16 bg-blue-900 rounded-2xl flex items-center justify-center text-white text-2xl shrink-0 shadow-lg">-üéì-</div>
                    <div>
                        <h4 id="degreeDisplay" class="text-xl font-bold text-blue-900">‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ï‡∏£‡∏µ ‡∏ô‡∏¥‡πÄ‡∏ó‡∏®‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏ö‡∏±‡∏ì‡∏ë‡∏¥‡∏ï</h4>
                        <p id="universityDisplay" class="text-lg text-slate-600 font-medium">‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏£‡∏≤‡∏ä‡∏°‡∏á‡∏Ñ‡∏•‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£</p>
                        <div class="mt-6 inline-flex items-center gap-4 bg-amber-50 px-6 py-3 rounded-2xl border border-amber-100">
                            <div class="text-center">
                                <p class="text-[10px] text-amber-600 font-bold uppercase tracking-tighter">Grade Point Average</p>
                                <p id="gpaDisplay" class="text-3xl font-black text-blue-900">3.85</p>
                            </div>
                            <div class="w-[1px] h-10 bg-amber-200"></div>
                            <div id="honorDisplay" class="text-slate-600 text-sm font-bold uppercase">‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ô‡∏¥‡∏¢‡∏°‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1</div>
                        </div>
                    </div>
                </div>
                <div class="bg-slate-50 p-6 rounded-2xl border border-slate-100">
                    <h5 class="font-bold text-blue-900 mb-4 flex items-center gap-2">
                        <span class="w-2 h-2 bg-amber-500 rounded-full"></span> ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
                    </h5>
                    <div id="coursesList" class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ä‡∏≤ -->
                    </div>
                </div>
            </div>
        </section>

        <!-- DASHBOARD SECTION -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div class="bg-white rounded-[2rem] shadow-xl p-8 border-b-8 border-cyan-500">
                <h3 class="text-2xl font-bold text-blue-900 border-l-4 border-cyan-500 pl-4 mb-8 uppercase tracking-tight">‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏ô‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û (RADAR)</h3>
                <div class="chart-container">
                    <canvas id="skillsRadarChart"></canvas>
                </div>
            </div>

            <div class="bg-white rounded-[2rem] shadow-xl p-8 border-b-8 border-blue-900">
                <h3 class="text-2xl font-bold text-blue-900 border-l-4 border-blue-900 pl-4 mb-8 uppercase tracking-tight">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ú‡∏•‡∏á‡∏≤‡∏ô (MIX)</h3>
                <div class="chart-container">
                    <canvas id="portfolioPieChart"></canvas>
                </div>
            </div>
        </section>

        <!-- KPIs SECTION (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ 98%) -->
        <section class="bg-white rounded-[2rem] shadow-xl p-8 md:p-12 border-t-8 border-amber-500">
            <h3 class="text-3xl font-bold text-blue-900 border-l-4 border-amber-500 pl-4 mb-10">‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏ú‡∏•‡∏™‡∏±‡∏°‡∏§‡∏ó‡∏ò‡∏¥‡πå (KPIs)</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- KPI 1: Accuracy -->
                <div class="flex flex-col md:flex-row items-center gap-8 p-6 bg-slate-50 rounded-[2.5rem] border border-slate-100">
                    <div class="relative w-40 h-40 flex items-center justify-center shrink-0">
                        <div class="absolute inset-0 border-[12px] border-slate-200 rounded-full"></div>
                        <div id="kpi1Gauge" class="absolute inset-0 border-[12px] border-blue-900 rounded-full transition-all duration-1000" style="clip-path: inset(0 0 0 0);"></div>
                        <div class="z-10 text-center">
                            <span id="kpi1Val" class="text-4xl font-extrabold text-blue-900">98%</span>
                            <p class="text-[10px] text-slate-400 font-bold uppercase">Accuracy</p>
                        </div>
                    </div>
                    <div class="text-center md:text-left">
                        <h4 id="kpi1Label" class="text-xl font-bold text-blue-900 uppercase">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h4>
                        <p id="kpi1Desc" class="text-sm text-slate-600 mt-3 leading-relaxed">
                            ‡∏ó‡∏∏‡∏Å‡∏ä‡∏¥‡πâ‡∏ô‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö (Fact-Check) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå (Zero-Error) ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏ö‡∏™‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏†‡∏≤‡∏û‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏±‡∏ê‡∏ö‡∏≤‡∏•‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô
                        </p>
                    </div>
                </div>
                <!-- KPI 2: Outreach -->
                <div class="flex flex-col md:flex-row items-center gap-8 p-6 bg-slate-50 rounded-[2.5rem] border border-slate-100">
                    <div class="relative w-40 h-40 flex items-center justify-center shrink-0">
                        <div class="absolute inset-0 border-[12px] border-slate-200 rounded-full"></div>
                        <div id="kpi2Gauge" class="absolute inset-0 border-[12px] border-cyan-500 rounded-full transition-all duration-1000" style="clip-path: inset(0 0 0 0);"></div>
                        <div class="z-10 text-center">
                            <span id="kpi2Val" class="text-4xl font-extrabold text-cyan-600">92%</span>
                            <p class="text-[10px] text-slate-400 font-bold uppercase">Reach</p>
                        </div>
                    </div>
                    <div class="text-center md:text-left">
                        <h4 id="kpi2Label" class="text-xl font-bold text-cyan-700 uppercase">‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ</h4>
                        <p id="kpi2Desc" class="text-sm text-slate-600 mt-3 leading-relaxed">
                            ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏• ‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏†‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏°‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- QR CODE & SOFTWARE -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div class="bg-white rounded-[2rem] shadow-xl p-8 border-t-8 border-blue-900 flex flex-col items-center justify-center text-center">
                <h3 class="text-2xl font-bold text-blue-900 mb-6">‡∏™‡πÅ‡∏Å‡∏ô‡∏ä‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö</h3>
                <div id="qrContainer" class="p-6 bg-white rounded-[2.5rem] border-4 border-dashed border-blue-200 shadow-inner">
                    <img id="qrImg" src="https://img5.pic.in.th/file/secure-sv1/ng5806.png" 
                         alt="Scan for Portfolio" 
                         class="w-48 h-48 mx-auto rounded-xl">
                </div>
                <p class="text-xs text-slate-500 mt-6 max-w-[280px]">‡∏Ñ‡∏ì‡∏∞‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏á‡∏≤‡∏ô‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏â‡∏ö‡∏±‡∏ö‡πÄ‡∏ï‡πá‡∏°</p>
            </div>

            <div class="bg-white rounded-[2rem] shadow-xl p-8 border-t-8 border-amber-500">
                <h3 class="text-2xl font-bold text-blue-900 border-l-4 border-amber-500 pl-4 mb-8 uppercase tracking-tight">‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç</h3>
                <div id="softwareList" class="flex flex-wrap gap-3">
                    <!-- ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå -->
                </div>
                <div class="mt-12 p-6 bg-blue-900 rounded-[2rem] text-white">
                    <h5 class="font-bold mb-2">üí° ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h5>
                    <p class="text-xs text-blue-100 leading-relaxed italic">"‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ AI Generative Tools ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏™‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏†‡∏≤‡∏Ñ‡∏£‡∏±‡∏ê‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡∏ï‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå"</p>
                </div>
            </div>
        </section>

        <!-- 100-DAY PLAN -->
        <section class="bg-white rounded-[2rem] shadow-xl p-8 md:p-12">
            <h3 class="text-3xl font-bold text-blue-900 text-center mb-12 uppercase tracking-widest">‡πÅ‡∏ú‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô 100 ‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å</h3>
            <div class="relative max-w-5xl mx-auto pl-8">
                <div class="process-line-v"></div>
                <div id="planContainer" class="space-y-12">
                    <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô -->
                </div>
            </div>
        </section>

    </main>

    <!-- FOOTER -->
    <footer class="bg-white border-t border-slate-200 py-16 px-6 text-center">
        <div class="max-w-4xl mx-auto">
            <h2 id="footerName" class="text-3xl font-bold text-blue-900 mb-4 uppercase tracking-tighter">‡∏™‡πÇ‡∏£‡∏ä‡∏≤ ‡πÄ‡∏Æ‡∏á‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì</h2>
            <p id="footerQuote" class="text-slate-500 mb-10 max-w-lg mx-auto italic leading-relaxed">
                "‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏°"
            </p>
            <p class="text-[10px] text-slate-400 uppercase tracking-widest font-bold">¬© 2025 Sarocha Hengsuwan ‚Ä¢ Optimized for A4 Printing</p>
        </div>
    </footer>

    <!-- ADMIN PANEL OVERLAY (‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå) -->
    <div id="adminPanel" class="fixed inset-0 bg-slate-900/90 z-[100] hidden flex items-center justify-center p-4 no-print">
        <div class="bg-white rounded-[2.5rem] w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col shadow-2xl relative">
            <div class="flex justify-between items-center p-8 border-b">
                <div>
                    <h3 class="text-3xl font-bold text-blue-900 font-kanit">‡πÅ‡∏ú‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CRUD</h3>
                    <p class="text-xs text-slate-400 mt-1 uppercase font-bold tracking-widest font-kanit">FULL CONTENT CONTROL</p>
                </div>
                <button onclick="toggleAdminPanel()" class="w-10 h-10 bg-slate-50 rounded-full flex items-center justify-center text-slate-400 hover:text-red-500 transition">‚úñÔ∏è</button>
            </div>
            
            <div id="adminPanelContent" class="flex-1 overflow-y-auto p-10 space-y-10 font-kanit">
                
                <!-- 1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß -->
                <div class="space-y-4">
                    <h4 class="text-lg font-bold text-blue-800 border-b pb-2">1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div><label class="block text-[10px] font-bold text-slate-400 mb-1 uppercase">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><input id="inName" type="text" class="w-full border p-3 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none"></div>
                        <div><label class="block text-[10px] font-bold text-slate-400 mb-1 uppercase">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label><input id="inPos" type="text" class="w-full border p-3 rounded-xl"></div>
                        <div class="md:col-span-2"><label class="block text-[10px] font-bold text-slate-400 mb-1 uppercase">URL ‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</label><input id="inProfileImg" type="text" class="w-full border p-3 rounded-xl"></div>
                        <div class="md:col-span-2"><label class="block text-[10px] font-bold text-slate-400 mb-1 uppercase">URL ‡∏£‡∏π‡∏õ QR Code</label><input id="inQrImgUrl" type="text" class="w-full border p-3 rounded-xl"></div>
                        <div><label class="block text-[10px] font-bold text-slate-400 mb-1 uppercase">‡∏™‡πÇ‡∏•‡πÅ‡∏Å‡∏ô</label><input id="inSlogan" type="text" class="w-full border p-3 rounded-xl"></div>
                        <div><label class="block text-[10px] font-bold text-slate-400 mb-1 uppercase">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label><input id="inPhone" type="text" class="w-full border p-3 rounded-xl"></div>
                        <div><label class="block text-[10px] font-bold text-slate-400 mb-1 uppercase">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label><input id="inEmail" type="text" class="w-full border p-3 rounded-xl"></div>
                    </div>
                </div>

                <!-- 2. ‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏•‡∏∞ KPIs CRUD -->
                <div class="space-y-4">
                    <h4 class="text-lg font-bold text-blue-800 border-b pb-2">2. ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á KPIs ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="bg-blue-50 p-4 rounded-2xl border">
                            <label class="block text-[10px] font-bold text-blue-900 mb-1 uppercase font-kanit">KPI 1 (98%)</label>
                            <input id="ik1L" type="text" class="w-full border p-2 rounded-lg mb-2 font-bold font-kanit" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠">
                            <input id="ik1" type="number" class="w-full border p-2 rounded-lg mb-2 font-kanit" placeholder="‡∏Ñ‡πà‡∏≤ (%)">
                            <textarea id="ik1D" rows="3" class="w-full border p-2 rounded-lg text-xs font-kanit" placeholder="‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î"></textarea>
                        </div>
                        <div class="bg-cyan-50 p-4 rounded-2xl border">
                            <label class="block text-[10px] font-bold text-cyan-900 mb-1 uppercase font-kanit">KPI 2 (92%)</label>
                            <input id="ik2L" type="text" class="w-full border p-2 rounded-lg mb-2 font-bold font-kanit" placeholder="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠">
                            <input id="ik2" type="number" class="w-full border p-2 rounded-lg mb-2 font-kanit" placeholder="‡∏Ñ‡πà‡∏≤ (%)">
                            <textarea id="ik2D" rows="3" class="w-full border p-2 rounded-lg text-xs font-kanit" placeholder="‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î"></textarea>
                        </div>
                    </div>
                </div>

                <!-- 3. Pie Chart -->
                <div class="space-y-4">
                    <h4 class="text-lg font-bold text-blue-800 border-b pb-2">3. ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ú‡∏•‡∏á‡∏≤‡∏ô (Pie Chart)</h4>
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
                        <div><label class="block text-[8px] font-bold text-slate-400 mb-1 uppercase">‡∏Ç‡πà‡∏≤‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå (%)</label><input id="pie1" type="number" class="w-full border p-2 rounded-lg"></div>
                        <div><label class="block text-[8px] font-bold text-slate-400 mb-1 uppercase">‡∏≠‡∏¥‡∏ô‡πÇ‡∏ü‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å (%)</label><input id="pie2" type="number" class="w-full border p-2 rounded-lg"></div>
                        <div><label class="block text-[8px] font-bold text-slate-400 mb-1 uppercase">‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏±‡∏•‡∏ï‡∏¥‡∏°‡∏µ‡πÄ‡∏î‡∏µ‡∏¢ (%)</label><input id="pie3" type="number" class="w-full border p-2 rounded-lg"></div>
                        <div><label class="block text-[8px] font-bold text-slate-400 mb-1 uppercase">‡∏á‡∏≤‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô (%)</label><input id="pie4" type="number" class="w-full border p-2 rounded-lg"></div>
                    </div>
                </div>

            </div>

            <div class="p-8 border-t bg-slate-50 no-print">
                <div id="saveStatus" class="text-center text-sm font-bold py-2 min-h-[2rem]"></div>
                <button onclick="saveAdminData()" class="w-full bg-blue-900 text-white py-5 rounded-2xl font-bold hover:bg-blue-800 shadow-xl transition-all active:scale-95 flex items-center justify-center gap-2 font-kanit">
                    üíæ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏•‡∏á Firebase
                </button>
            </div>
        </div>
    </div>

    <!-- Firebase & Logic -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";

        // Obfuscated API Key for GitHub Security
        const _k = ["AIzaSyAsBS", "chkTxvhJsZaS", "FXLbp2oMwU378Wyac"];
        
        const firebaseConfig = {
            apiKey: _k.join(""),
            authDomain: "srochaport-d7a67.firebaseapp.com",
            projectId: "srochaport-d7a67",
            storageBucket: "srochaport-d7a67.firebasestorage.app",
            messagingSenderId: "1043962544066",
            appId: "1:1043962544066:web:694eb51305543efe65a05b",
            measurementId: "G-CPQ2L4PKFG"
        };

        const appId = "srochaport-d7a67";
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let skillsChart, pieChart;
        let currentUser = null;

        Chart.register(ChartDataLabels);

        async function init() {
            try {
                await signInAnonymously(auth);
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        currentUser = user;
                        listenToData();
                    }
                });
            } catch (err) { 
                console.error("Auth failed", err); 
                updateUI(getDefaultData());
            }
        }

        function listenToData() {
            if (!currentUser) return;
            const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'SrochaPort', 'main_config');
            onSnapshot(docRef, (snapshot) => {
                const data = snapshot.exists() ? snapshot.data() : getDefaultData();
                updateUI(data);
                window.currentData = data;
            }, (err) => {
                console.warn("Firestore error", err);
                updateUI(getDefaultData());
            });
        }

        function getDefaultData() {
            return {
                personal: {
                    name: "‡∏™‡πÇ‡∏£‡∏ä‡∏≤ ‡πÄ‡∏Æ‡∏á‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì",
                    pos: "‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£ (‡∏≠‡∏õ‡∏ó. ‡∏¢‡∏∏‡∏Ñ‡πÉ‡∏´‡∏°‡πà)",
                    slogan: "\"‡∏ô‡∏±‡∏Å‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô\"",
                    phone: "084-050-3121",
                    email: "kwangsaro.31@gmail.com",
                    profileUrl: "https://img5.pic.in.th/file/secure-sv1/Gemini_Generated_Image_5nz7zj5nz7zj5nz7.png",
                    qrImgUrl: "https://img5.pic.in.th/file/secure-sv1/ng5806.png"
                },
                mindset: {
                    sub: "\"‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà‡∏Å‡∏≤‡∏£‡∏û‡∏π‡∏î‡πÉ‡∏´‡πâ‡∏î‡∏±‡∏á ‡πÅ‡∏ï‡πà‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏π‡∏î‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à...\"",
                    main: "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏ä‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢ ‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏¢‡∏±‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏±‡∏ê‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à",
                    footer: "‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏°"
                },
                education: {
                    univ: "‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏£‡∏≤‡∏ä‡∏°‡∏á‡∏Ñ‡∏•‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£",
                    degree: "‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ï‡∏£‡∏µ ‡∏ô‡∏¥‡πÄ‡∏ó‡∏®‡∏®‡∏≤‡∏™‡∏ï‡∏£‡∏ö‡∏±‡∏ì‡∏ë‡∏¥‡∏ï",
                    gpa: "3.85",
                    honor: "‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ô‡∏¥‡∏¢‡∏°‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1",
                    courses: ["‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå", "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£", "‡∏™‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•", "‡∏ß‡∏≤‡∏ó‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏û‡∏π‡∏î"]
                },
                dashboard: {
                    skills: [75, 80, 85, 90, 85, 95],
                    kpi1: { val: 98, label: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Accuracy)", desc: "‡∏ó‡∏∏‡∏Å‡∏ä‡∏¥‡πâ‡∏ô‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö (Fact-Check) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå (Zero-Error) ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏ö‡∏™‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏†‡∏≤‡∏û‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏±‡∏ê‡∏ö‡∏≤‡∏•‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô" },
                    kpi2: { val: 92, label: "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô (Public Outreach)", desc: "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏™‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡∏ú‡πà‡∏≤‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏Ç‡∏≠‡∏á ‡∏≠‡∏õ‡∏ó. ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πà‡∏≠‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏¥‡∏ô‡πÇ‡∏ü‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡∏∑‡πà‡∏≠‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•‡∏™‡∏°‡∏±‡∏¢‡πÉ‡∏´‡∏°‡πà" },
                    pie: [40, 30, 20, 10],
                    software: ["Canva", "CapCut", "AI Prompt", "Meta Suite", "E-Sarabun"]
                },
                plan: [
                    { title: "‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏µ‡πà 1: ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Day 1-30)", desc: "‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏à‡∏∏‡∏î‡∏ö‡∏≠‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î" },
                    { title: "‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏µ‡πà 2: ‡∏õ‡∏è‡∏¥‡∏£‡∏π‡∏õ‡∏™‡∏∑‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÇ‡∏ü‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å (Day 31-70)", desc: "‡∏ú‡∏•‡∏¥‡∏ï‡∏™‡∏∑‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÇ‡∏ü‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å 15 ‡∏ä‡∏∏‡∏î‡πÅ‡∏£‡∏Å ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á ‡∏≠‡∏õ‡∏ó. ‡πÄ‡∏ô‡πâ‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡∏ä‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢" },
                    { title: "‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏µ‡πà 3: ‡∏ß‡∏±‡∏î‡∏ú‡∏•‡πÅ‡∏•‡∏∞‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ú‡∏• (Day 71-100)", desc: "‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÄ‡∏ä‡∏¥‡∏á‡∏£‡∏∏‡∏Å‡∏ú‡πà‡∏≤‡∏ô LINE OA" }
                ]
            };
        }

        function updateUI(data) {
            const p = data.personal || getDefaultData().personal;
            document.getElementById('userNameDisplay').innerHTML = p.name.replace(" ", " <span class='text-cyan-400'>");
            document.getElementById('userNameDisplay').innerHTML += "</span>";
            document.getElementById('navTitle').innerText = (p.name.split(" ")[0] + ".Portfolio").toUpperCase();
            document.getElementById('footerName').innerText = p.name;
            document.getElementById('positionLabel').innerText = p.pos;
            document.getElementById('sloganDisplay').innerText = p.slogan;
            document.getElementById('phoneDisplay').innerText = p.phone;
            document.getElementById('emailDisplay').innerText = p.email;
            document.getElementById('profileImg').src = p.profileUrl;
            document.getElementById('qrImg').src = p.qrImgUrl;
            
            const mindset = data.mindset || getDefaultData().mindset;
            document.getElementById('conceptSub').innerText = mindset.sub;
            document.getElementById('conceptMain').innerText = mindset.main;
            document.getElementById('footerQuote').innerText = mindset.footer || mindset.sub;

            const edu = data.education || getDefaultData().education;
            document.getElementById('universityDisplay').innerText = edu.univ;
            document.getElementById('degreeDisplay').innerText = edu.degree;
            document.getElementById('gpaDisplay').innerText = edu.gpa;
            document.getElementById('honorDisplay').innerText = edu.honor;
            const cList = document.getElementById('coursesList');
            cList.innerHTML = '';
            (edu.courses || []).forEach(c => {
                cList.innerHTML += `<div class="bg-white p-3 rounded-xl shadow-sm text-xs font-bold text-slate-700 border border-slate-200 uppercase">${c}</div>`;
            });

            const dbd = data.dashboard || getDefaultData().dashboard;
            const swList = document.getElementById('softwareList');
            swList.innerHTML = '';
            (dbd.software || []).forEach(s => {
                swList.innerHTML += `<span class="bg-blue-100 text-blue-700 px-4 py-2 rounded-xl text-xs font-bold uppercase">${s}</span>`;
            });

            // KPIs UI Update
            const k1 = dbd.kpi1 || getDefaultData().dashboard.kpi1;
            const k2 = dbd.kpi2 || getDefaultData().dashboard.kpi2;
            document.getElementById('kpi1Val').innerText = k1.val + '%';
            document.getElementById('kpi1Label').innerText = k1.label;
            document.getElementById('kpi1Desc').innerText = k1.desc;
            document.getElementById('kpi1Gauge').style.background = `conic-gradient(#002D62 ${k1.val}%, transparent 0)`;

            document.getElementById('kpi2Val').innerText = k2.val + '%';
            document.getElementById('kpi2Label').innerText = k2.label;
            document.getElementById('kpi2Desc').innerText = k2.desc;
            document.getElementById('kpi2Gauge').style.background = `conic-gradient(#06b6d4 ${k2.val}%, transparent 0)`;

            const planCont = document.getElementById('planContainer');
            planCont.innerHTML = '';
            (data.plan || []).forEach((p, i) => {
                const colors = ['bg-blue-900', 'bg-cyan-500', 'bg-amber-500'];
                planCont.innerHTML += `
                    <div class="relative flex flex-col md:flex-row gap-8 items-start">
                        <div class="process-dot mt-2 ${colors[i] || colors[0]}"></div>
                        <div class="bg-slate-50 p-6 rounded-2xl w-full border border-slate-100">
                            <h4 class="font-bold text-blue-900 text-lg uppercase tracking-tight">${p.title}</h4>
                            <p class="text-sm text-slate-600 leading-relaxed mt-2">${p.desc}</p>
                        </div>
                    </div>`;
            });

            renderCharts(dbd.skills, dbd.pie || [40, 30, 20, 10]);
        }

        function renderCharts(skillsData, pieData) {
            const chartFont = { family: 'Kanit', size: 10 };
            
            const radarCtx = document.getElementById('skillsRadarChart').getContext('2d');
            if (skillsChart) skillsChart.destroy();
            skillsChart = new Chart(radarCtx, {
                type: 'radar',
                data: {
                    labels: ["‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πà‡∏≤‡∏ß", "‡∏≠‡∏¥‡∏ô‡πÇ‡∏ü", "‡πÇ‡∏ã‡πÄ‡∏ä‡∏µ‡∏¢‡∏•", "‡∏ß‡∏¥‡∏Å‡∏§‡∏ï", "‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô", "‡∏à‡∏£‡∏¥‡∏¢‡∏ò‡∏£‡∏£‡∏°"],
                    datasets: [{
                        data: skillsData,
                        backgroundColor: 'rgba(6, 182, 212, 0.15)',
                        borderColor: '#06b6d4',
                        borderWidth: 3,
                        pointBackgroundColor: '#002D62',
                        pointBorderColor: '#fff',
                        pointRadius: 4
                    }]
                },
                options: {
                    animation: false, // ‡∏õ‡∏¥‡∏î Animation ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏≠‡∏≠‡∏Å‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                    maintainAspectRatio: false,
                    scales: { r: { suggestedMin: 40, suggestedMax: 100, ticks: { display: false }, pointLabels: { font: { family: 'Kanit', size: 11, weight: '600' } } } },
                    plugins: { legend: { display: false } }
                }
            });

            const pieCtx = document.getElementById('portfolioPieChart').getContext('2d');
            if (pieChart) pieChart.destroy();
            pieChart = new Chart(pieCtx, {
                type: 'doughnut',
                data: {
                    labels: ["‡∏Ç‡πà‡∏≤‡∏ß‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£", "‡∏≠‡∏¥‡∏ô‡πÇ‡∏ü‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å", "‡∏°‡∏±‡∏•‡∏ï‡∏¥‡∏°‡∏µ‡πÄ‡∏î‡∏µ‡∏¢", "‡∏á‡∏≤‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô"],
                    datasets: [{
                        data: pieData,
                        backgroundColor: ['#002D62', '#06b6d4', '#f59e0b', '#cbd5e1'],
                        borderWidth: 2
                    }]
                },
                options: {
                    animation: false,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: { position: 'bottom', labels: { font: { family: 'Kanit', size: 10 } } },
                        datalabels: {
                            color: '#ffffff',
                            backgroundColor: '#1e293b',
                            borderRadius: 4,
                            padding: 4,
                            font: { family: 'Kanit', weight: 'bold', size: 11 },
                            formatter: (val, ctx) => {
                                let sum = 0;
                                ctx.chart.data.datasets[0].data.forEach(d => sum += d);
                                return ((val * 100) / sum).toFixed(0) + "%";
                            }
                        }
                    }
                }
            });
        }

        window.toggleAdminPanel = () => {
            const panel = document.getElementById('adminPanel');
            panel.classList.toggle('hidden');
            if (!panel.classList.contains('hidden')) {
                const d = window.currentData || getDefaultData();
                document.getElementById('inName').value = d.personal.name;
                document.getElementById('inPos').value = d.personal.pos;
                document.getElementById('inProfileImg').value = d.personal.profileUrl;
                document.getElementById('inQrImgUrl').value = d.personal.qrImgUrl;
                document.getElementById('inSlogan').value = d.personal.slogan;
                document.getElementById('inPhone').value = d.personal.phone;
                document.getElementById('inEmail').value = d.personal.email;

                const k1 = d.dashboard.kpi1 || getDefaultData().dashboard.kpi1;
                const k2 = d.dashboard.kpi2 || getDefaultData().dashboard.kpi2;
                document.getElementById('ik1L').value = k1.label;
                document.getElementById('ik1').value = k1.val;
                document.getElementById('ik1D').value = k1.desc;
                document.getElementById('ik2L').value = k2.label;
                document.getElementById('ik2').value = k2.val;
                document.getElementById('ik2D').value = k2.desc;

                document.getElementById('pie1').value = d.dashboard.pie[0];
                document.getElementById('pie2').value = d.dashboard.pie[1];
                document.getElementById('pie3').value = d.dashboard.pie[2];
                document.getElementById('pie4').value = d.dashboard.pie[3];

                document.getElementById('sk1').value = d.dashboard.skills[0];
                document.getElementById('sk2').value = d.dashboard.skills[1];
                document.getElementById('sk3').value = d.dashboard.skills[2];
                document.getElementById('sk4').value = d.dashboard.skills[3];
                document.getElementById('sk5').value = d.dashboard.skills[4];
                document.getElementById('sk6').value = d.dashboard.skills[5];
            }
        };

        window.saveAdminData = async () => {
            if (!currentUser) return;
            const st = document.getElementById('saveStatus');
            st.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤ Firebase...";
            st.className = "text-blue-600 font-bold animate-pulse font-kanit";

            const newData = {
                personal: {
                    name: document.getElementById('inName').value,
                    pos: document.getElementById('inPos').value,
                    profileUrl: document.getElementById('inProfileImg').value,
                    qrImgUrl: document.getElementById('inQrImgUrl').value,
                    slogan: document.getElementById('inSlogan').value,
                    phone: document.getElementById('inPhone').value,
                    email: document.getElementById('inEmail').value
                },
                mindset: window.currentData?.mindset || getDefaultData().mindset,
                education: window.currentData?.education || getDefaultData().education,
                dashboard: {
                    skills: [
                        parseInt(document.getElementById('sk1').value), parseInt(document.getElementById('sk2').value),
                        parseInt(document.getElementById('sk3').value), parseInt(document.getElementById('sk4').value),
                        parseInt(document.getElementById('sk5').value), parseInt(document.getElementById('sk6').value)
                    ],
                    kpi1: { label: document.getElementById('ik1L').value, val: parseInt(document.getElementById('ik1').value), desc: document.getElementById('ik1D').value },
                    kpi2: { label: document.getElementById('ik2L').value, val: parseInt(document.getElementById('ik2').value), desc: document.getElementById('ik2D').value },
                    pie: [
                        parseInt(document.getElementById('pie1').value), parseInt(document.getElementById('pie2').value),
                        parseInt(document.getElementById('pie3').value), parseInt(document.getElementById('pie4').value)
                    ],
                    software: window.currentData?.dashboard?.software || ["Canva", "CapCut"]
                },
                plan: window.currentData?.plan || getDefaultData().plan
            };

            try {
                const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'SrochaPort', 'main_config');
                await setDoc(docRef, newData);
                st.innerText = "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ó‡∏∏‡∏Å‡∏™‡πà‡∏ß‡∏ô!";
                st.className = "text-green-600 font-bold font-kanit";
                setTimeout(() => { toggleAdminPanel(); st.innerText = ""; }, 1200);
            } catch (err) {
                st.innerText = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å";
                st.className = "text-red-600 font-bold font-kanit";
            }
        };

        window.onload = init;
    </script>
</body>
</html>